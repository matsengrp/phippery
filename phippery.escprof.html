<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Escape Profile &mdash; phippery 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command Line Interface" href="command-line-interface.html" />
    <link rel="prev" title="Eigen" href="phippery.eigen.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            phippery
              <img src="_static/Xarray_function.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Nextflow Pipeline:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="alignments-pipeline.html">Alignments Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="alignments-pipeline.html#input-files">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="alignments-pipeline.html#pipeline-results">Pipeline results</a></li>
<li class="toctree-l1"><a class="reference internal" href="alignments-pipeline.html#parameters">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="alignments-pipeline.html#optional-parameters">Optional Parameters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="phippery.utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="phippery.normalize.html">Normalize</a></li>
<li class="toctree-l1"><a class="reference internal" href="phippery.modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="phippery.eigen.html">Eigen</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Escape Profile</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Line Interface:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="command-line-interface.html">Command Line Interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Streamlit Viz App</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="streamlit-app.html">Streamlit Viz App</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Methods Descriptions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="esc-prof.html">Comparing Escape Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bkg-model.html">Background Modeling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Rest of It</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="the-rest-of-it.html">Gotchas</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-rest-of-it.html#contributing">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">phippery</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Escape Profile</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/phippery.escprof.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="module-phippery.escprof"></span><section id="escape-profile">
<h1>Escape Profile<a class="headerlink" href="#escape-profile" title="Permalink to this heading"></a></h1>
<p>Use
<a class="reference external" href="https://en.wikipedia.org/wiki/Transportation_theory_(mathematics)">optimal transport method</a>
to compare
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S2589004220308142">phage-dms</a>
escape profiles.
See the escape profile <a class="reference internal" href="esc-prof.html#sec-escape-profile-comparisons"><span class="std std-ref">description and examples</span></a>.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="phippery.escprof.compute_sim_score">
<span class="sig-prename descclassname"><span class="pre">phippery.escprof.</span></span><span class="sig-name descname"><span class="pre">compute_sim_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/phippery/escprof.html#compute_sim_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phippery.escprof.compute_sim_score" title="Permalink to this definition"></a></dt>
<dd><p>Returns the similarity score given
two distributions and the cost matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>list</em>) – A distribution of relative contribution for each amino acid to scaled differential selection.</p></li>
<li><p><strong>b</strong> (<em>list</em>) – Another distribution of relative contribution for each amino acid to scaled differential selection.</p></li>
<li><p><strong>cost_matrix</strong> (<em>list</em>) – The cost matrix to evaluate optimal transport from a to b.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The similarity score (reciprocal of the optimal transport cost).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="phippery.escprof.get_cost_matrix">
<span class="sig-prename descclassname"><span class="pre">phippery.escprof.</span></span><span class="sig-name descname"><span class="pre">get_cost_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/phippery/escprof.html#get_cost_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phippery.escprof.get_cost_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Returns the default 40x40 cost matrix based on BLOSUM62
and assigns maximum cost to transport between
opposite signed differential selection contributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>40x40 matrix (as a list of lists)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="phippery.escprof.get_loc_esc_distr">
<span class="sig-prename descclassname"><span class="pre">phippery.escprof.</span></span><span class="sig-name descname"><span class="pre">get_loc_esc_distr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfact_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/phippery/escprof.html#get_loc_esc_distr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phippery.escprof.get_loc_esc_distr" title="Permalink to this definition"></a></dt>
<dd><p>Returns the normalized distribution represented as a list
for the amino acid pattern of scaled differential
selection for a specified individual and amino acid site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataSet</em>) – The dataset containing the sample of interest.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – The name of the scaled differential selection data in ds.</p></li>
<li><p><strong>sample_factor</strong> (<em>str</em>) – The sample annotation label to identify the individual sample (e.g. ‘sample_ID’).</p></li>
<li><p><strong>sfact_val</strong> (<em>str</em>) – The sample_factor value to identify the sample of interest.</p></li>
<li><p><strong>loc</strong> (<em>int</em>) – The location number for the amino acid site of interest.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The relative contributions to the total absolute scaled differential selection at the site.
The first 20 entries are contributions to negative selection (binding loss).
The last 20 entries are contributions to positive selection (binding gain).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="phippery.escprof.loc_sim_score">
<span class="sig-prename descclassname"><span class="pre">phippery.escprof.</span></span><span class="sig-name descname"><span class="pre">loc_sim_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfact_val1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfact_val2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/phippery/escprof.html#loc_sim_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phippery.escprof.loc_sim_score" title="Permalink to this definition"></a></dt>
<dd><p>Returns the similarity score for comparison at a site between two samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataSet</em>) – The dataset containing the sample of interest.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – The name of the scaled differential selection data in ds.</p></li>
<li><p><strong>cost_matrix</strong> (<em>list</em>) – The cost matrix to evaluate optimal transport between two distributions.</p></li>
<li><p><strong>sample_factor</strong> (<em>str</em>) – The sample annotation label to identify the samples (e.g. ‘sample_ID’).</p></li>
<li><p><strong>sfact_val1</strong> (<em>str</em>) – The sample_factor value to identify sample 1.</p></li>
<li><p><strong>sfact_val2</strong> (<em>str</em>) – The sample_factor value to identify sample 2.</p></li>
<li><p><strong>loc</strong> (<em>int</em>) – The location number for the amino acid site of interest.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The similarity score at the amino acid site.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="phippery.escprof.region_sim_score">
<span class="sig-prename descclassname"><span class="pre">phippery.escprof.</span></span><span class="sig-name descname"><span class="pre">region_sim_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfact_val1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfact_val2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/phippery/escprof.html#region_sim_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phippery.escprof.region_sim_score" title="Permalink to this definition"></a></dt>
<dd><p>Returns the similarity score for comparison in the
region [loc_start, loc_end].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataSet</em>) – The dataset containing the sample of interest</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – The name of the scaled differential selection data in ds.</p></li>
<li><p><strong>cost_matrix</strong> (<em>list</em>) – The cost matrix to evaluate optimal transport between two distributions.</p></li>
<li><p><strong>sample_factor</strong> (<em>str</em>) – The sample annotation label to identify the samples (e.g. ‘sample_ID’).</p></li>
<li><p><strong>sfact_val1</strong> (<em>str</em>) – The sample_factor value to identify sample 1.</p></li>
<li><p><strong>sfact_val2</strong> (<em>str</em>) – The sample_factor value to identify sample 2.</p></li>
<li><p><strong>loc_start</strong> (<em>int</em>) – The location number for the first amino acid site in the region of interest.</p></li>
<li><p><strong>loc_end</strong> (<em>int</em>) – The location number for the last amino acid site in the region of interest.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The similarity score for the region.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="phippery.eigen.html" class="btn btn-neutral float-left" title="Eigen" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="command-line-interface.html" class="btn btn-neutral float-right" title="Command Line Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Jared G. Galloway, Kevin Sung.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>